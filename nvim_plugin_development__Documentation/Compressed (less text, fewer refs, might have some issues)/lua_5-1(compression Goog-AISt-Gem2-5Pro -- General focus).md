| Module / Category / Command             | API / Function / Concept                           | Description & Purpose                                                                                                                                                                                                                                                                             | Key Parameters / Usage / Notes                                                                                                                                                                                                                                                     | Return Values                                                                                                                                 | Example / Relevance                                                                                                                                                                   |
| --------------------------------------- | -------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------ | ------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------- | ------------------------------------------------------ |
| **INTRODUCTION**                        | `lua-intro`                                        | Lua 5.1 script engine is built-in and always available. Nvim includes a "standard library" (`vim` module) `[NUMHI]`, complementing editor stdlib ([vimscript-functions](), [Ex-commands]()) and the [API](). Lua plugins/config auto-discovered.                                                  | Nvim can run Lua scripts from shell: `nvim -l foo.lua [args...]`.                                                                                                                                                                                                                  | N/A                                                                                                                                           | `:lua vim.print(package.loaded)`                                                                                                                                                      |
|                                         | `lua-compat`                                       | Lua 5.1 is the permanent interface. Plugins must target Lua 5.1. Extensions like `goto` (even if in LuaJIT) are not supported.                                                                                                                                                                    | Specified in [luaref](). Later Lua versions are incompatible dialects.                                                                                                                                                                                                             | N/A                                                                                                                                           | Ensure plugin code adheres to Lua 5.1 standard.                                                                                                                                       |
|                                         | `lua-luajit`                                       | Nvim should be built with LuaJIT for performance. LuaJIT offers extensions (`ffi`, profiling, enhanced stdlib). `[NUMHI]`                                                                                                                                                                         | Code should check `jit` global variable before using LuaJIT extensions. `bit` extension is always available (fallback provided if PUC Lua).                                                                                                                                        | N/A                                                                                                                                           | `if jit then -- luajit code else -- plain lua 5.1 end`                                                                                                                                |
|                                         | `lua-profile`                                      | Lua code profiling if Nvim built with LuaJIT. `[NUMHI]`                                                                                                                                                                                                                                           | `require('jit.p').start('ri1', '/tmp/profile')` to start. `require('jit.p').stop()` to stop. Profile written to file.                                                                                                                                                              | N/A                                                                                                                                           | `:lua vim.cmd.edit(package.searchpath('jit.p', package.path))` to view source.                                                                                                        |
| **LUA CONCEPTS AND IDIOMS**             | `lua-concepts`                                     | Lua is simple and consistent. Three fundamental mechanisms: tables, closures, coroutines. `[NUMHI]`                                                                                                                                                                                               | Tables: list/map datastructure, extendable with [metatable](). Closures: every scope (function, module, `do` block). Coroutines: cooperative multithreading, generators.                                                                                                           | N/A                                                                                                                                           | Understanding these is key to effective Lua programming in Nvim.                                                                                                                      |
|                                         | `lua-error-handling`                               | Functions may throw [lua-errors]() for exceptional failures (handle with `pcall()`). For normal/expected failures, idiomatic to return `nil` (result-or-message pattern). `[NUMHI]`                                                                                                               | Result-or-message: `any                                                                                                                                                                                                                                                            | nil, nil                                                                                                                                      | string`(result/nil, nil/error_message). Use`assert()` if caller can't proceed on failure. Use for functions with expected external failures (HTTP, LSP) or value-returning functions. | N/A                                                                | `local val = assert(fn_that_returns_nil_err())`   |
|                                         | `iterator`                                         | A function called repeatedly for the "next" value of a collection. `[NUMHI]`                                                                                                                                                                                                                      | Expected by `for-in` loops, produced by `pairs()`, supported by `vim.iter()`.                                                                                                                                                                                                      | N/A                                                                                                                                           | `for k, v in pairs(my_table) do ... end`                                                                                                                                              |
|                                         | `iterable`                                         | Anything `vim.iter()` can consume: tables, dicts, lists, iterator functions, tables with `__call` metamethod, `vim.iter()` objects. `[NUMHI]`                                                                                                                                                     |                                                                                                                                                                                                                                                                                    | N/A                                                                                                                                           | `vim.iter(my_table):map(...)`                                                                                                                                                         |
|                                         | `list-iterator`                                    | Iterators on [lua-list]() tables have a "middle" and "end" (finite). `[NUMHI]`                                                                                                                                                                                                                    | Some `vim.iter` operations (e.g., `Iter:rev()`) only make sense on list-like tables.                                                                                                                                                                                               | N/A                                                                                                                                           | Iterating over a Lua list.                                                                                                                                                            |
|                                         | `lua-function-call`                                | Standard call: `foo(1, 2)`. Missing args are `nil`. Extra args discarded. `[NUMHI]`                                                                                                                                                                                                               |                                                                                                                                                                                                                                                                                    | N/A                                                                                                                                           | `foo(1) -- second arg is nil`                                                                                                                                                         |
|                                         | `kwargs`                                           | Parentheses can be omitted if function takes exactly one string literal or table literal. Used to mimic named parameters ("keyword args"). `[NUMHI]`                                                                                                                                              | Table literal: `{ foo = true, filename = "bar" }`.                                                                                                                                                                                                                                 | N/A                                                                                                                                           | `func_with_opts { foo = true, file = "a" }`                                                                                                                                           |
|                                         | `lua-regex`                                        | Lua has limited [lua-pattern]()s, not full regex. Use Vim regex via `vim.regex()`. `[NUMHI]`                                                                                                                                                                                                      | Patterns use `%` as escape. `string.match("foo123", "%d+")` -> "123".                                                                                                                                                                                                              | N/A                                                                                                                                           | `print(string.match("foo.bar", "%.bar")) -- .bar`                                                                                                                                     |
| **IMPORTING LUA MODULES**               | `lua-module-load`                                  | Modules searched in `'runtimepath'` & [packages-runtimepath]() under `lua/`. `.` in module name is dir separator. Search order: `lua/foo/bar.lua`, then `lua/foo/bar/init.lua`. Shared libs `lua/foo/bar.?` also searched. Falls back to Lua default search. `require()` caches result. `[NUMHI]` | `package.path` and `package.cpath` are initialized based on `'runtimepath'`. Semicolons in `'runtimepath'` paths are skipped.                                                                                                                                                      | `true` or returned value from script                                                                                                          | `require('myplugin.utils')`                                                                                                                                                           |
| **COMMANDS**                            | `[:lua=]()` / `[:lua]()`                           | `:lua {chunk}`: Executes Lua chunk. `[NUMHI]` If starts with `=`, rest is evaluated as expression and printed (`:lua =expr` is like `:lua print(vim.inspect(expr))`). `:=expr` is equivalent.                                                                                                     | Each chunk has own scope. Global vars shared. `print()` redirects to Nvim message area.                                                                                                                                                                                            | N/A                                                                                                                                           | `:lua vim.api.nvim_command('echo "Hi"')`, `:lua print(_VERSION)`, `:lua =jit.version`                                                                                                 |
|                                         | `:{range}lua`                                      | Executes buffer lines in `{range}` as Lua code. `[NUMHI]`                                                                                                                                                                                                                                         | Unlike `:source`, always treats lines as Lua.                                                                                                                                                                                                                                      | N/A                                                                                                                                           | Select Lua code in buffer, type `:lua<Enter>`.                                                                                                                                        |
|                                         | `[:lua-heredoc]()`                                 | `:lua << [trim] ['{endmarker}'] {script} {endmarker}`: Executes Lua script from Vimscript. `[NUMHI]`                                                                                                                                                                                              | Can omit `endmarker` and use `.` after script. `local` vars disappear after block.                                                                                                                                                                                                 | N/A                                                                                                                                           | `function! X() lua << EOF print('Hi') EOF endfunction`                                                                                                                                |
|                                         | `[:luado]()`                                       | `:[range]luado {body}`: Executes Lua chunk `function(line, linenr) {body} end` for each line in `[range]`. `[NUMHI]`                                                                                                                                                                              | `line`: current line text. `linenr`: current line number. If function returns string, it becomes new line text. Default `[range]` is whole file.                                                                                                                                   | N/A                                                                                                                                           | `:luado return line:reverse()`                                                                                                                                                        |
|                                         | `[:luafile]()`                                     | `:luafile {file}`: Executes Lua script in `{file}`. `[NUMHI]`                                                                                                                                                                                                                                     | Whole argument is filename (spaces don't need escaping). Can also `:source` Lua files.                                                                                                                                                                                             | N/A                                                                                                                                           | `:luafile script.lua`, `:luafile %`                                                                                                                                                   |
| **`luaeval()`**                         | `lua-eval`                                         | Vimscript `luaeval(expstr, arg)` executes Lua `expstr`. `arg` available as `_A` in Lua. Converts Lua types to Vimscript. `[NUMHI]`                                                                                                                                                                | Lua nils, numbers, strings, tables, booleans converted. Lua string with NUL -> [Blob](). Other types error. `_A` contains `arg`. Tables: empty is list; `vim.empty_dict()` for dict. `[vim.type_idx]` for specific types (float, array, dict).                                     | Converted Vimscript value                                                                                                                     | `:echo luaeval('_A[1] + _A[2]', [40, 2]) -- 42`                                                                                                                                       |
|                                         | `lua-table-ambiguous`                              | Rules for Lua table to Vimscript conversion: `[NUMHI]`                                                                                                                                                                                                                                            | 0. Empty table is a list. Use `vim.empty_dict()` for empty dict. 1. Table with 1..N integer keys is list. 2. Table with string keys (no NUL) is dict. 3. Table with string keys (some NUL) is `msgpack-special-map`. 4. Table with `vim.type_idx` key can be list, dict, or float. | N/A                                                                                                                                           | Governs how `luaeval()` and `v:lua` return values are handled.                                                                                                                        |
| **Vimscript `v:lua` interface**         | `v:lua-call`                                       | Vimscript `call v:lua.func(arg1, arg2)` equivalent to Lua `return func(...)`. `[NUMHI]` `call v:lua.require'mod'.func(args)`.                                                                                                                                                                     | Only single quote form for `require` without parens. Cannot get `Funcref` to Lua function. Args converted Vimscript -> Lua, return Lua -> Vimscript.                                                                                                                               | Converted Lua return value                                                                                                                    | `call v:lua.mymod.omnifunc(findstart, base)`, `vim.bo[buf].omnifunc = 'v:lua.mymod.omnifunc'`                                                                                         |
| **Lua standard modules (`vim` module)** | `lua-stdlib`                                       | The `vim` module is Nvim's Lua "standard library". Always loaded (no `require("vim")` needed). Exposes functions and sub-modules. `[NUMHI]`                                                                                                                                                       | Underscore-prefixed functions are internal. Help: `:help vim.deepcopy()`.                                                                                                                                                                                                          | N/A                                                                                                                                           | `:lua vim.print(vim)` to inspect.                                                                                                                                                     |
| `VIM.UV`                                | `vim.uv` / `lua-loop`                              | Exposes "luv" Lua bindings for libUV (networking, filesystem, process). `[NUMHI]` Interacts with Nvim main [luv-event-loop]().                                                                                                                                                                    | Error [E5560]() to call `vim.api` (except [api-fast]()) in `vim.uv` callbacks. Use `vim.schedule_wrap()` to defer.                                                                                                                                                                 | Luv objects (timer, handle, etc.)                                                                                                             | `timer = vim.uv.new_timer()`, `timer:start(1000, 0, vim.schedule_wrap(cb))`                                                                                                           |
|                                         | `watch-file`                                       | Example: File-change detection using `vim.uv.new_fs_event()`. `[NUMHI]`                                                                                                                                                                                                                           | Callback uses `vim.schedule_wrap()`. Needs to handle debouncing. On Linux, may need to increase `inotify` limits.                                                                                                                                                                  | N/A                                                                                                                                           | Watch file, call `checktime` on change.                                                                                                                                               |
|                                         | `tcp-server`                                       | Example: TCP echo-server using `vim.uv.new_tcp()`.                                                                                                                                                                                                                                                | `server:bind()`, `server:listen()`, `server:accept()`, `sock:read_start()`, `sock:write()`, `sock:close()`.                                                                                                                                                                        | N/A                                                                                                                                           | Creates a server that echoes back received TCP data.                                                                                                                                  |
|                                         | `lua-loop-threading`                               | Plugins can use luv threading APIs (`vim.uv.new_thread`). Each thread has separate Lua state, no direct access to editor state.                                                                                                                                                                   | Subset of `vim.*` available: `vim.uv` (separate loop), `vim.mpack`, `vim.json`, `require`, `print`, `vim.inspect`, `vim.diff`, utility fns. `vim.is_thread()` is true in non-main thread.                                                                                          | N/A                                                                                                                                           | For offloading work to OS threads.                                                                                                                                                    |
| `VIM.HL`                                | `vim.hl`                                           | Module for highlighting. `[NUMHI]`                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                    |                                                                                                                                               |                                                                                                                                                                                       |
|                                         | `vim.hl.on_yank({opts})`                           | Highlights yanked text during [TextYankPost]. `[NUMHI]`                                                                                                                                                                                                                                           | `opts`: `{higroup (def "IncSearch"), timeout (def 150), on_macro (def false), on_visual (def true), event (def vim.v.event), priority (def vim.hl.priorities.user)}`.                                                                                                              | N/A                                                                                                                                           | `autocmd TextYankPost * silent! lua vim.hl.on_yank({higroup='Visual'})`                                                                                                               |
|                                         | `vim.hl.priorities`                                | Table with default priorities for highlighting: `syntax (50), treesitter (100), semantic_tokens (125), diagnostics (150), user (200)`. `[NUMHI]`                                                                                                                                                  |                                                                                                                                                                                                                                                                                    | Table                                                                                                                                         | Used by `vim.hl.on_yank`, `vim.hl.range`.                                                                                                                                             |
|                                         | `vim.hl.range(bufnr, ns, hg, start, finish, opts)` | Apply highlight group to text range. `[NUMHI]`                                                                                                                                                                                                                                                    | `start`/`finish`: `(line, col)` tuple or `getpos()` string. `opts`: `{regtype (def 'v'), inclusive (def false), priority (def user), timeout (def -1)}`.                                                                                                                           | `uv.uv_timer_t?` (if timeout), `fun()?` (clear fn, if timeout)                                                                                | Apply temporary highlight to a code region.                                                                                                                                           |
| `VIM.DIFF`                              | `vim.diff`                                         | Module for diffing strings. `[NUMHI]`                                                                                                                                                                                                                                                             |                                                                                                                                                                                                                                                                                    |                                                                                                                                               |                                                                                                                                                                                       |
|                                         | `vim.diff(a, b, opts)`                             | Runs diff on strings `a` and `b`. Returns 1-based indices. `[NUMHI]`                                                                                                                                                                                                                              | `opts`: `{on_hunk (fun(start_a,cnt_a,start_b,cnt_b):int?), result_type ('unified' (def)                                                                                                                                                                                            | 'indices'), linematch (bool                                                                                                                   | int), algorithm ('myers'(def)                                                                                                                                                         | 'minimal'                                                          | 'patience'                                        | 'histogram'), ctxlen, interhunkctxlen, ignore_whitespace, ignore_whitespace_change, ignore_whitespace_change_at_eol, ignore_cr_at_eol, ignore_blank_lines, indent_heuristic}`. | `string` or `integer[][]?`. `nil` if `on_hunk` given. | `vim.diff('a\n', 'b\nc\n', {result_type = 'indices'})` |
| `VIM.MPACK`                             | `vim.mpack`                                        | Encode/decode Lua objects to/from msgpack strings. Supports `vim.NIL`, `vim.empty_dict()`. `[NUMHI]`                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                    |                                                                                                                                               |                                                                                                                                                                                       |
|                                         | `vim.mpack.decode(str)`                            | Decodes msgpack string to Lua object. `[NUMHI]`                                                                                                                                                                                                                                                   | `str`: string.                                                                                                                                                                                                                                                                     | `any`                                                                                                                                         | `local data = vim.mpack.decode(msgpack_string)`                                                                                                                                       |
|                                         | `vim.mpack.encode(obj)`                            | Encodes Lua object to msgpack string. `[NUMHI]`                                                                                                                                                                                                                                                   | `obj`: any.                                                                                                                                                                                                                                                                        | `string`                                                                                                                                      | `local bytes = vim.mpack.encode({key = "value"})`                                                                                                                                     |
| `VIM.JSON`                              | `vim.json`                                         | Encode/decode Lua objects to/from JSON strings. Supports `vim.NIL`, `vim.empty_dict()`. `[NUMHI]`                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                    |                                                                                                                                               |                                                                                                                                                                                       |
|                                         | `vim.json.decode(str, opts)`                       | Decodes JSON string to Lua. JSON `null` -> `vim.NIL` (or `nil` via `opts.luanil`). Empty obj -> `vim.empty_dict()`. `[NUMHI]`                                                                                                                                                                     | `opts`: `{luanil: {object=bool, array=bool}}` to control `null` to Lua `nil` conversion.                                                                                                                                                                                           | `any`                                                                                                                                         | `vim.json.decode('{"foo":null}')` -> `{foo = vim.NIL}` `[NUMHI]`                                                                                                                      |
|                                         | `vim.json.encode(obj, opts)`                       | Encodes Lua object to JSON string. `[NUMHI]`                                                                                                                                                                                                                                                      | `opts`: `{escape_slash=bool (def false)}`.                                                                                                                                                                                                                                         | `string`                                                                                                                                      | `vim.json.encode({answer=42})` -> `'{"answer":42}'` `[NUMHI]`                                                                                                                         |
| `VIM.BASE64`                            | `vim.base64`                                       | Base64 encoding/decoding.                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                    |                                                                                                                                               |                                                                                                                                                                                       |
|                                         | `vim.base64.decode(str)`                           | Decodes Base64 string.                                                                                                                                                                                                                                                                            | `str`: Base64 string.                                                                                                                                                                                                                                                              | `string` (decoded)                                                                                                                            |                                                                                                                                                                                       |
|                                         | `vim.base64.encode(str)`                           | Encodes string using Base64.                                                                                                                                                                                                                                                                      | `str`: String to encode.                                                                                                                                                                                                                                                           | `string` (encoded)                                                                                                                            |                                                                                                                                                                                       |
| `VIM.SPELL`                             | `vim.spell`                                        | Spelling check functions.                                                                                                                                                                                                                                                                         |                                                                                                                                                                                                                                                                                    |                                                                                                                                               |                                                                                                                                                                                       |
|                                         | `vim.spell.check(str)`                             | Checks string for spelling errors. Like `spellbadword()`. Depends on `'spelllang'`, etc. (consider `nvim_buf_call`).                                                                                                                                                                              | `str`: string.                                                                                                                                                                                                                                                                     | `[string, 'bad'                                                                                                                               | 'rare'                                                                                                                                                                                | 'local'                                                            | 'caps', integer][]` (word, type, position)        | `vim.spell.check("quik brown")` -> `{{'quik', 'bad', 1}}` (example adjusted)                                                                                                   |
| **VIM (builtin functions/vars)**        | `vim.api`                                          | `vim.api.{func}({...})`: Invokes Nvim [API]() function `{func}`. `[NUMHI]`                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                                    | API function's return value                                                                                                                   | `vim.api.nvim_get_current_line()`                                                                                                                                                     |
|                                         | `vim.NIL`                                          | Special value for NIL in [RPC]() / `v:null` in Vimscript. Lua `nil` is treated as missing in tables. `[NUMHI]`                                                                                                                                                                                    |                                                                                                                                                                                                                                                                                    | Special table value                                                                                                                           | Use in tables passed to API or returned from `luaeval`.                                                                                                                               |
|                                         | `vim.type_idx`                                     | Type index for [lua-special-tbl] to specify type of empty table or force [Float] for integral numbers. `[NUMHI]`                                                                                                                                                                                  | Use with `vim.types`.                                                                                                                                                                                                                                                              | Special table key                                                                                                                             | `{[vim.type_idx]=vim.types.dictionary}` for empty dict.                                                                                                                               |
|                                         | `vim.val_idx`                                      | Value index for tables representing [Float]s in [lua-special-tbl]. `[NUMHI]`                                                                                                                                                                                                                      |                                                                                                                                                                                                                                                                                    | Special table key                                                                                                                             | `{[vim.type_idx]=vim.types.float, [vim.val_idx]=1.0}`                                                                                                                                 |
|                                         | `vim.types`                                        | Table with values for `vim.type_idx` (e.g., `float`, `array`, `dictionary`) and their string names. `[NUMHI]`                                                                                                                                                                                     | `vim.types[vim.types[value]] == value`.                                                                                                                                                                                                                                            | Table                                                                                                                                         | `vim.types.float`, `vim.types.dictionary`.                                                                                                                                            |
|                                         | `vim.log.levels`                                   | Table with log level constants: `DEBUG, ERROR, INFO, TRACE, WARN, OFF`. `[NUMHI]`                                                                                                                                                                                                                 | Used with `vim.notify()`.                                                                                                                                                                                                                                                          | Table                                                                                                                                         | `vim.notify("message", vim.log.levels.INFO)`                                                                                                                                          |
|                                         | `vim.empty_dict()`                                 | Creates special empty table marked as dictionary for Nvim conversion (default `{}` is list). `[NUMHI]`                                                                                                                                                                                            | Ignored if numeric keys present.                                                                                                                                                                                                                                                   | `table`                                                                                                                                       | Use when an API function expects an empty dictionary. `[NUMHI]`                                                                                                                       |
|                                         | `vim.iconv(str, from, to)`                         | Converts string encoding using `iconv()`. `?` for unconvertible chars.                                                                                                                                                                                                                            | `str, from, to`: strings.                                                                                                                                                                                                                                                          | `string?` (converted string or `nil` on failure)                                                                                              | `vim.iconv(text, "latin1", "utf-8")`                                                                                                                                                  |
|                                         | `vim.in_fast_event()`                              | True if in "fast" event (e.g., `vim.uv` callbacks) where most API is disabled. `[NUMHI]`                                                                                                                                                                                                          | Check before calling slow API fns. Use `vim.schedule_wrap`.                                                                                                                                                                                                                        | `boolean`                                                                                                                                     | Useful in async callbacks. `[NUMHI]`                                                                                                                                                  |
|                                         | `vim.rpcnotify(ch, meth, ...)`                     | Sends RPC event, returns immediately. `ch=0` broadcasts. Works in fast callbacks. `[NUMHI]`                                                                                                                                                                                                       | `ch`: integer. `meth`: string. `...`: any.                                                                                                                                                                                                                                         | N/A                                                                                                                                           | For inter-process communication with Nvim.                                                                                                                                            |
|                                         | `vim.rpcrequest(ch, meth, ...)`                    | Sends RPC request, blocks for response. `vim.NIL` for nil results. `[NUMHI]`                                                                                                                                                                                                                      | `ch`: integer. `meth`: string. `...`: any.                                                                                                                                                                                                                                         | `any` (response from remote)                                                                                                                  | For inter-process communication with Nvim.                                                                                                                                            |
|                                         | `vim.schedule(fn)`                                 | Schedules `fn` for soon execution by main event-loop. Avoids `textlock`. `[NUMHI]`                                                                                                                                                                                                                | `fn`: `fun()`.                                                                                                                                                                                                                                                                     | N/A                                                                                                                                           | `vim.schedule(function() print("Delayed") end)`. `[NUMHI]`                                                                                                                            |
|                                         | `vim.str_utf_end(str, index)`                      | Gets distance (bytes) from last byte of codepoint at `index`.                                                                                                                                                                                                                                     | `str`: string. `index`: integer (byte index).                                                                                                                                                                                                                                      | `integer`                                                                                                                                     | `vim.str_utf_end('æ', 2)` -> 0.                                                                                                                                                       |
|                                         | `vim.str_utf_pos(str)`                             | List of starting byte positions of UTF-8 codepoints. NUL terminates.                                                                                                                                                                                                                              | `str`: string.                                                                                                                                                                                                                                                                     | `integer[]`                                                                                                                                   | `vim.str_utf_pos('abc')` -> `{1, 2, 3}`.                                                                                                                                              |
|                                         | `vim.str_utf_start(str, index)`                    | Gets distance (bytes) from starting byte of codepoint at `index`.                                                                                                                                                                                                                                 | `str`: string. `index`: integer (byte index).                                                                                                                                                                                                                                      | `integer`                                                                                                                                     | `vim.str_utf_start('æ', 2)` -> -1.                                                                                                                                                    |
|                                         | `vim.stricmp(a, b)`                                | Compares strings case-insensitively.                                                                                                                                                                                                                                                              | `a, b`: strings.                                                                                                                                                                                                                                                                   | `0` (equal), `1` (a > b), `-1` (a < b)                                                                                                        | `vim.stricmp("Foo", "foo")` -> 0.                                                                                                                                                     |
|                                         | `vim.ui_attach(ns, opts, cb)`                      | **Experimental**. Subscribe to [ui-events](). `cb` receives event name + params. For custom screen elements. `[NUMHI]`                                                                                                                                                                            | `ns`: integer. `opts`: `{ext_...=bool}` for [ui-ext-options](), `{set_cmdheight=bool}`. `cb(event, ...)`: function. Callbacks for `msg_show` are `api-fast`. Errors force detach.                                                                                                  | N/A                                                                                                                                           | `vim.ui_attach(ns, {ext_popupmenu=true}, my_pum_handler)`. `[NUMHI]`                                                                                                                  |
|                                         | `vim.ui_detach(ns)`                                | Detach callback from `vim.ui_attach()`. `[NUMHI]`                                                                                                                                                                                                                                                 | `ns`: integer (Namespace ID).                                                                                                                                                                                                                                                      | N/A                                                                                                                                           |                                                                                                                                                                                       |
|                                         | `vim.wait(time, cb, interval, fast_only)`          | Wait `time` ms or until `cb()` is true. Processes events. `cb()` polled at `interval`. Cannot call in `api-fast`. `[NUMHI]`                                                                                                                                                                       | `time`: integer (ms). `cb`: `fun(): bool?` (optional). `interval`: integer (ms, def 200). `fast_only`: bool.                                                                                                                                                                       | `boolean`, (`-1` timeout                                                                                                                      | `-2` interrupted?)                                                                                                                                                                    | `vim.wait(100, function() return vim.g.my_var end)`. `[NUMHI]`     |
| **LUA-VIMSCRIPT BRIDGE**                | `vim.call(func, ...)`                              | Invokes [vim-function]() or [user-function]() `func`. Like `vim.fn[func]({...})`. `[NUMHI]`                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                    | Vim function's return value (converted)                                                                                                       | `vim.call('getline', 1)`                                                                                                                                                              |
|                                         | `vim.cmd(command)`                                 | See `vim.cmd()` under "Lua module: vim". `[NUMHI]`                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                    |                                                                                                                                               |                                                                                                                                                                                       |
|                                         | `vim.fn`                                           | `vim.fn.{func}({...})`: Invokes Vim function. Converts types. `vim.NIL` for `v:null`. Autoload: `vim.fn['some#func']({...})`. `[NUMHI]`                                                                                                                                                           | Most cannot run in `api-fast` callbacks. Keys generated lazily.                                                                                                                                                                                                                    | Vim function's return value (converted)                                                                                                       | `vim.fn.abs(-1)`. `[NUMHI]`                                                                                                                                                           |
|                                         | `lua-vim-variables`                                | `vim.g`, `vim.b`, `vim.w`, `vim.t`, `vim.v` access Vimscript global/buffer/window/tab/v: vars. `[NUMHI]`                                                                                                                                                                                          | Set: `vim.g.foo = 5`. Get: `print(vim.g.foo)`. Delete: `vim.g.foo = nil`. For dict fields, copy-modify-reassign. `vim.b[bufnr]` etc. for specific scope.                                                                                                                           | Table (metatable for access)                                                                                                                  | `vim.g.my_plugin_setting = true`. `[NUMHI]`                                                                                                                                           |
|                                         | `lua-options`                                      | Vim options via `vim.o` (like `:set`), `vim.bo` (buffer-local), `vim.wo` (window-local), `vim.go` (global). `[NUMHI]`                                                                                                                                                                             | `vim.o.number = true`. `vim.o.wildignore = '*.o'`. `vim.bo[bufnr].buflisted = true`. `vim.wo[winid].number = true`.                                                                                                                                                                | Table (metatable for access)                                                                                                                  | `vim.o.textwidth = 80`. `[NUMHI]`                                                                                                                                                     |
|                                         | `vim.opt`                                          | Special interface for list/map-style options. Access as Lua tables. Methods: `:append()`, `:prepend()`, `:remove()`, `:get()`. `[NUMHI]` Also `vim.opt_local`, `vim.opt_global`.                                                                                                                  | Set list: `vim.opt.wildignore = {'*.o'}`. Set map: `vim.opt.listchars = {tab='>~'}`. Append: `opt:append('val')`. Get: `opt:get()`.                                                                                                                                                | `Option` object                                                                                                                               | `vim.opt.formatoptions:append('j')`. `vim.print(vim.opt.wildignore:get())`. `[NUMHI]`                                                                                                 |
|                                         | `Option:append(value)`                             | Appends `value` to string-style options (like `set+=`). `[NUMHI]`                                                                                                                                                                                                                                 | `value`: string.                                                                                                                                                                                                                                                                   | self (`Option` object)                                                                                                                        | `vim.opt.formatoptions:append('j')`                                                                                                                                                   |
|                                         | `Option:get()`                                     | Returns Lua representation of the option value. Lists -> array, Maps -> table, Flags -> set-like table. `[NUMHI]`                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                    | `string                                                                                                                                       | integer                                                                                                                                                                               | boolean                                                            | table`                                            | `local fo_table = vim.opt.formatoptions:get()`                                                                                                                                 |
|                                         | `Option:prepend(value)`                            | Prepends `value` to string-style options (like `set^=`). `[NUMHI]`                                                                                                                                                                                                                                | `value`: string.                                                                                                                                                                                                                                                                   | self (`Option` object)                                                                                                                        | `vim.opt.wildignore:prepend('*.tmp')`                                                                                                                                                 |
|                                         | `Option:remove(value)`                             | Removes `value` from string-style options (like `set-=`). `[NUMHI]`                                                                                                                                                                                                                               | `value`: string.                                                                                                                                                                                                                                                                   | self (`Option` object)                                                                                                                        | `vim.opt.wildignore:remove('*.o')`                                                                                                                                                    |
|                                         | `vim.env`                                          | Environment variables. Invalid/unset key -> `nil`. `[NUMHI]`                                                                                                                                                                                                                                      | `vim.env.FOO = 'bar'`. `print(vim.env.TERM)`.                                                                                                                                                                                                                                      | Table (metatable for access)                                                                                                                  | Access/modify environment for Nvim session. `[NUMHI]`                                                                                                                                 |
| **Lua module: `vim`**                   | `vim.cmd(command)`                                 | Executes Vimscript Ex-command(s). String for multiple lines (like `:source`), table for single command (like `nvim_cmd`). Can be indexed with command name: `vim.cmd.echo(...)`. `[NUMHI]`                                                                                                        | `command`: `string` or `table {cmd, args, bang}`.                                                                                                                                                                                                                                  | N/A                                                                                                                                           | `vim.cmd('echo 42')`, `vim.cmd.colorscheme('blue')`. `[NUMHI]`                                                                                                                        |
|                                         | `vim.defer_fn(fn, timeout)`                        | Defers calling `fn` until `timeout` ms passes. `fn` is `vim.schedule_wrap()`ped. `[NUMHI]`                                                                                                                                                                                                        | `fn`: function. `timeout`: integer (ms).                                                                                                                                                                                                                                           | `table` (luv timer object)                                                                                                                    | `vim.defer_fn(my_func, 100)`. `[NUMHI]`                                                                                                                                               |
|                                         | `vim.deprecate(name, alt, ver, plugin, bt)`        | Shows deprecation message. `[NUMHI]`                                                                                                                                                                                                                                                              | `name`: string (deprecated feature). `alt`: string? (alternative). `ver`: string (removal version). `plugin`: string? (def "Nvim"). `bt`: boolean? (backtrace, def true).                                                                                                          | `string?` (message or nil)                                                                                                                    | `vim.deprecate('old_fn', 'new_fn', '0.10.0', 'myplugin')`                                                                                                                             |
|                                         | `vim.inspect(obj)`                                 | Gets human-readable representation of object. `[NUMHI]`                                                                                                                                                                                                                                           | `obj`: any.                                                                                                                                                                                                                                                                        | `string`                                                                                                                                      | `print(vim.inspect({a=1}))`. `[NUMHI]`                                                                                                                                                |
|                                         | `vim.keycode(str)`                                 | Translates keycodes (e.g., `<bs>`).                                                                                                                                                                                                                                                               | `str`: string.                                                                                                                                                                                                                                                                     | `string`                                                                                                                                      | `vim.g.mapleader = vim.keycode'<bs>'`                                                                                                                                                 |
|                                         | `vim.lua_omnifunc(find_start)`                     | Omnifunc for Lua completion (like `:lua` command completion).                                                                                                                                                                                                                                     | `find_start`: 1 or 0.                                                                                                                                                                                                                                                              | Varies (omnifunc result)                                                                                                                      | `set omnifunc=v:lua.vim.lua_omnifunc` in Lua buffer.                                                                                                                                  |
|                                         | `vim.notify(msg, level, opts)`                     | Displays notification. Can be overridden. Default to `:messages`. `[NUMHI]`                                                                                                                                                                                                                       | `msg`: string. `level`: integer? (from `vim.log.levels`). `opts`: table? (unused by default).                                                                                                                                                                                      | N/A                                                                                                                                           | `vim.notify("Error!", vim.log.levels.ERROR)`. `[NUMHI]`                                                                                                                               |
|                                         | `vim.notify_once(msg, ...)`                        | Like `vim.notify`, but only displays once per message. `[NUMHI]`                                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                    | `boolean` (true if displayed)                                                                                                                 |                                                                                                                                                                                       |
|                                         | `vim.on_key(fn, ns_id, opts)`                      | Adds Lua fn listener to every input key. `fn(key, typed)` returns str to replace key or empty to discard. Removed on error. Not recursive. `[NUMHI]`                                                                                                                                              | `fn`: `fun(key: string, typed: string): string??` or `nil` to remove. `ns_id`: integer? (nil/0 generates new). `opts`: table.                                                                                                                                                      | `integer` (ns_id or count of callbacks)                                                                                                       | `vim.on_key(my_key_handler_fn)`. `[NUMHI]`                                                                                                                                            |
|                                         | `vim.paste(lines, phase)`                          | Paste handler, invoked by `nvim_paste()`. For hooking paste. `[NUMHI]`                                                                                                                                                                                                                            | `lines`: `string[]`. `phase`: -1 (non-streaming), 1 (start), 2 (continue), 3 (end).                                                                                                                                                                                                | `boolean` (false to cancel paste)                                                                                                             | Override `vim.paste` to modify pasted lines.                                                                                                                                          |
|                                         | `vim.print(...)`                                   | "Pretty prints" arguments and returns them unmodified. `[NUMHI]`                                                                                                                                                                                                                                  | `...`: any.                                                                                                                                                                                                                                                                        | `any` (given arguments)                                                                                                                       | `local x = vim.print(my_data)`. `[NUMHI]`                                                                                                                                             |
|                                         | `vim.schedule_wrap(fn)`                            | Returns function which calls `fn` via `vim.schedule()`, passing all args. `[NUMHI]`                                                                                                                                                                                                               | `fn`: function.                                                                                                                                                                                                                                                                    | `function`                                                                                                                                    | `vim.uv.fs_access(path, "R", vim.schedule_wrap(cb))`. `[NUMHI]`                                                                                                                       |
|                                         | `vim.str_byteindex(s, enc, idx, strict?)`          | Convert UTF-32/16/8 `idx` to byte index. `strict_indexing=false` returns len on OOB.                                                                                                                                                                                                              | `enc`: "utf-8"                                                                                                                                                                                                                                                                     | "utf-16"                                                                                                                                      | "utf-32". `idx`: integer. `strict_indexing`: bool (def true).                                                                                                                         | `integer`                                                          |                                                   |
|                                         | `vim.str_utfindex(s, enc, idx?, strict?)`          | Convert byte `idx` (or len) to UTF-32/16/8 index. All 0-based. `strict_indexing=false` returns len on OOB. Invalid UTF-8/surrogates count as 1.                                                                                                                                                   | `enc`: "utf-8"                                                                                                                                                                                                                                                                     | "utf-16"                                                                                                                                      | "utf-32". `idx`: integer?. `strict_indexing`: bool (def true).                                                                                                                        | `integer`                                                          |                                                   |
|                                         | `vim.system(cmd, opts, on_exit)`                   | Runs system command. Throws error if cmd cannot run. `[NUMHI]`                                                                                                                                                                                                                                    | `cmd`: `string[]`. `opts`: `vim.SystemOpts` (cwd, env, clear_env, stdin, stdout, stderr, text, timeout, detach). `on_exit`: `fun(out: vim.SystemCompleted)?` (async if provided).                                                                                                  | `vim.SystemObj` (with `pid`, `wait`, `kill`, `write`, `is_closing`)                                                                           | `vim.system({'echo', 'hello'}, {text=true}):wait()`. `[NUMHI]`                                                                                                                        |
| **Lua module: `vim.inspector`**         | `vim.inspect_pos(buf, r, c, filter)`               | Get all items (syntax, treesitter, extmarks, semantic tokens) at buffer position. `:Inspect!` for pretty-print. Since 0.9.0. `[NUMHI]`                                                                                                                                                            | `bufnr?` (def current), `row?` (0-based, def cursor), `col?` (0-based, def cursor). `filter`: `{syntax,treesitter,extmarks,semantic_tokens}` (booleans, `extmarks` can be "all").                                                                                                  | `table` (with keys: treesitter, syntax, semantic_tokens, extmarks, buffer, row, col)                                                          | For debugging highlighting and extmarks. `[NUMHI]`                                                                                                                                    |
|                                         | `vim.show_pos(buf, r, c, filter)`                  | Show all items at buffer position. `:Inspect`. Since 0.9.0. `[NUMHI]`                                                                                                                                                                                                                             | Same params as `vim.inspect_pos`.                                                                                                                                                                                                                                                  | N/A                                                                                                                                           | `vim.keymap.set('n', 'zS', vim.show_pos)`. `[NUMHI]`                                                                                                                                  |
| `vim.Ringbuf`                           | `vim.Ringbuf` object                               | Returned by `vim.ringbuf()`. Fields: `clear`, `push`, `pop`, `peek`.                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                    | Object                                                                                                                                        |                                                                                                                                                                                       |
|                                         | `Ringbuf:clear()`                                  | Clear all items from ring buffer.                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                    | N/A                                                                                                                                           | `rb:clear()`                                                                                                                                                                          |
|                                         | `Ringbuf:peek()`                                   | Returns first unread item without removing it.                                                                                                                                                                                                                                                    |                                                                                                                                                                                                                                                                                    | `any?`                                                                                                                                        | `local item = rb:peek()`                                                                                                                                                              |
|                                         | `Ringbuf:pop()`                                    | Removes and returns first unread item.                                                                                                                                                                                                                                                            |                                                                                                                                                                                                                                                                                    | `any?`                                                                                                                                        | `local item = rb:pop()`                                                                                                                                                               |
|                                         | `Ringbuf:push(item)`                               | Adds item, overriding oldest if buffer is full.                                                                                                                                                                                                                                                   | `item`: any.                                                                                                                                                                                                                                                                       | N/A                                                                                                                                           | `rb:push("new_item")`                                                                                                                                                                 |
| **(vim module general utils)**          | `vim.deep_equal(a, b)`                             | Deep compare values. Tables compared recursively unless `eq` metamethod. Others use `==`.                                                                                                                                                                                                         | `a, b`: any.                                                                                                                                                                                                                                                                       | `boolean`                                                                                                                                     | `vim.deep_equal({k={}}, {k={}})` -> true.                                                                                                                                             |
|                                         | `vim.deepcopy(orig, noref?)`                       | Deep copy table. Functions copied by reference. `noref=true` faster for unique fields. Errors on userdata/threads. `[NUMHI]`                                                                                                                                                                      | `orig`: table. `noref`: boolean? (def false).                                                                                                                                                                                                                                      | `table`                                                                                                                                       | `local copy = vim.deepcopy(original_table)`. `[NUMHI]`                                                                                                                                |
|                                         | `vim.defaulttable(createfn?)`                      | Creates table where missing keys provided by `createfn(key)`. If `createfn` is nil, defaults to `defaulttable()` (nested tables).                                                                                                                                                                 | `createfn`: `fun(key:any):any?`.                                                                                                                                                                                                                                                   | `table` (with `__index` metamethod)                                                                                                           | `local a = vim.defaulttable(); a.b.c = 1`.                                                                                                                                            |
|                                         | `vim.endswith(s, suffix)`                          | Tests if string `s` ends with `suffix`.                                                                                                                                                                                                                                                           | `s, suffix`: strings.                                                                                                                                                                                                                                                              | `boolean`                                                                                                                                     | `vim.endswith("file.lua", ".lua")` -> true.                                                                                                                                           |
|                                         | `vim.gsplit(s, sep, opts?)`                        | Iterator that splits string at `sep` (pattern or literal if `opts.plain`). Lazy. `[NUMHI]`                                                                                                                                                                                                        | `s, sep`: strings. `opts`: `{plain=bool, trimempty=bool}`.                                                                                                                                                                                                                         | `fun():string?` (iterator)                                                                                                                    | `for part in vim.gsplit("a:b",":",{plain=true}) do print(part) end`. `[NUMHI]`                                                                                                        |
|                                         | `vim.is_callable(f)`                               | True if `f` can be called as a function. `[NUMHI]`                                                                                                                                                                                                                                                | `f`: any.                                                                                                                                                                                                                                                                          | `boolean`                                                                                                                                     | `if vim.is_callable(my_var) then my_var() end`. `[NUMHI]`                                                                                                                             |
|                                         | `vim.isarray(t)`                                   | True if `t` is table indexed only by integers (potentially non-contiguous). `{}` is array unless `vim.empty_dict()` or API dict.                                                                                                                                                                  | `t`: table?.                                                                                                                                                                                                                                                                       | `boolean`                                                                                                                                     |                                                                                                                                                                                       |
|                                         | `vim.islist(t)`                                    | True if `t` is table indexed by contiguous integers from 1. `{}` is list unless `vim.empty_dict()` or API dict. `[NUMHI]`                                                                                                                                                                         | `t`: table?.                                                                                                                                                                                                                                                                       | `boolean`                                                                                                                                     | Important for `vim.iter` behavior and API conversions. `[NUMHI]`                                                                                                                      |
|                                         | `vim.list_contains(t, value)`                      | Checks if list-like table `t` contains `value`. `[NUMHI]`                                                                                                                                                                                                                                         | `t`: table (list-like). `value`: any.                                                                                                                                                                                                                                              | `boolean`                                                                                                                                     | `vim.list_contains({1,2,3}, 2)` -> true. `[NUMHI]`                                                                                                                                    |
|                                         | `vim.list_extend(dst, src, start?, finish?)`       | Extends list `dst` with values from `src` (from `start` to `finish`). Modifies `dst`. `[NUMHI]`                                                                                                                                                                                                   | `dst, src`: tables. `start?, finish?`: integers.                                                                                                                                                                                                                                   | `table` (`dst`)                                                                                                                               | `local t1={1}; vim.list_extend(t1,{2,3})` -> t1 is `{1,2,3}`. `[NUMHI]`                                                                                                               |
|                                         | `vim.list_slice(list, start?, finish?)`            | Creates copy of table from `start` to `finish` (inclusive).                                                                                                                                                                                                                                       | `list`: `any[]`. `start?, finish?`: integers.                                                                                                                                                                                                                                      | `any[]`                                                                                                                                       | `vim.list_slice({1,2,3,4}, 2, 3)` -> `{2,3}`.                                                                                                                                         |
|                                         | `vim.pesc(s)`                                      | Escapes magic chars in [lua-pattern]()s. `[NUMHI]`                                                                                                                                                                                                                                                | `s`: string.                                                                                                                                                                                                                                                                       | `string` (%-escaped pattern)                                                                                                                  | `vim.pesc("foo.bar")` -> `"foo%.bar"`.                                                                                                                                                |
|                                         | `vim.ringbuf(size)`                                | Create a ring buffer. Adding new entry overrides oldest if full.                                                                                                                                                                                                                                  | `size`: integer.                                                                                                                                                                                                                                                                   | `vim.Ringbuf` object                                                                                                                          | `local rb = vim.ringbuf(3)`.                                                                                                                                                          |
|                                         | `vim.spairs(t)`                                    | Enumerates key-value pairs of table `t`, ordered by key.                                                                                                                                                                                                                                          | `t`: table (dict-like).                                                                                                                                                                                                                                                            | `fun()`, `table` (for-in iterator)                                                                                                            | `for k,v in vim.spairs(my_dict) do ... end`.                                                                                                                                          |
|                                         | `vim.split(s, sep, opts?)`                         | Splits string at `sep` (pattern or literal if `opts.plain`). Eager. Returns table. `[NUMHI]`                                                                                                                                                                                                      | `s, sep`: strings. `opts`: `{plain=bool, trimempty=bool}`.                                                                                                                                                                                                                         | `string[]`                                                                                                                                    | `vim.split("a:b:c", ":")` -> `{"a","b","c"}`. `[NUMHI]`                                                                                                                               |
|                                         | `vim.startswith(s, prefix)`                        | Tests if string `s` starts with `prefix`.                                                                                                                                                                                                                                                         | `s, prefix`: strings.                                                                                                                                                                                                                                                              | `boolean`                                                                                                                                     | `vim.startswith("foobar", "foo")` -> true.                                                                                                                                            |
|                                         | `vim.tbl_contains(t, val, opts?)`                  | Checks if table `t` contains `val` (or `val` is predicate if `opts.predicate=true`). `[NUMHI]`                                                                                                                                                                                                    | `t`: table. `val`: any or function. `opts`: `{predicate=bool}`.                                                                                                                                                                                                                    | `boolean`                                                                                                                                     | `vim.tbl_contains({a=1}, 1)`. `[NUMHI]`                                                                                                                                               |
|                                         | `vim.tbl_count(t)`                                 | Counts non-nil values in table `t`. `[NUMHI]`                                                                                                                                                                                                                                                     | `t`: table.                                                                                                                                                                                                                                                                        | `integer`                                                                                                                                     | `vim.tbl_count({a=1,b=nil,c=2})` -> 2. `[NUMHI]`                                                                                                                                      |
|                                         | `vim.tbl_deep_extend(beh, ...)`                    | Merges >=2 tables recursively. Lists are overwritten, not merged. `[NUMHI]`                                                                                                                                                                                                                       | `behavior`: 'error'                                                                                                                                                                                                                                                                | 'keep'                                                                                                                                        | 'force'                                                                                                                                                                               | `fun(key,prev,curr)`. `...`: tables.                               | `table` (merged)                                  | `vim.tbl_deep_extend('force', defaults, user_config)`. `[NUMHI]`                                                                                                               |
|                                         | `vim.tbl_extend(beh, ...)`                         | Merges >=2 tables (shallow). `[NUMHI]`                                                                                                                                                                                                                                                            | `behavior`: 'error'                                                                                                                                                                                                                                                                | 'keep'                                                                                                                                        | 'force'                                                                                                                                                                               | `fun(key,prev,curr)`. `...`: tables.                               | `table` (merged)                                  | `[NUMHI]`                                                                                                                                                                      |
|                                         | `vim.tbl_filter(func, t)`                          | Filters table `t` using predicate `func`.                                                                                                                                                                                                                                                         | `func`: function. `t`: table.                                                                                                                                                                                                                                                      | `any[]` (table of filtered values)                                                                                                            | `vim.tbl_filter(function(x) return x > 1 end, {1,2,3})` -> `{2,3}`.                                                                                                                   |
|                                         | `vim.tbl_get(o, ...)`                              | Index into table `o` via subsequent string keys. Returns `nil` if key DNE. `[NUMHI]`                                                                                                                                                                                                              | `o`: table. `...`: string keys.                                                                                                                                                                                                                                                    | `any` (nested value or `nil`)                                                                                                                 | `vim.tbl_get({a={b=1}}, 'a', 'b')` -> 1. `[NUMHI]`                                                                                                                                    |
|                                         | `vim.tbl_isempty(t)`                               | Checks if table `t` is empty. `[NUMHI]`                                                                                                                                                                                                                                                           | `t`: table.                                                                                                                                                                                                                                                                        | `boolean`                                                                                                                                     | `vim.tbl_isempty({})` -> true. `[NUMHI]`                                                                                                                                              |
|                                         | `vim.tbl_keys(t)`                                  | Returns list of all keys in table `t` (order not guaranteed). `[NUMHI]`                                                                                                                                                                                                                           | `t`: table.                                                                                                                                                                                                                                                                        | `any[]` (list of keys)                                                                                                                        | `vim.tbl_keys({a=1,b=2})` -> `{'a','b'}` (order may vary). `[NUMHI]`                                                                                                                  |
|                                         | `vim.tbl_map(func, t)`                             | Applies `func` to all values of table `t`. `[NUMHI]`                                                                                                                                                                                                                                              | `func`: function. `t`: table.                                                                                                                                                                                                                                                      | `table` (transformed values)                                                                                                                  | `vim.tbl_map(function(x) return x*2 end, {a=1,b=2})` -> `{a=2,b=4}`. `[NUMHI]`                                                                                                        |
|                                         | `vim.tbl_values(t)`                                | Returns list of all values in table `t` (order not guaranteed). `[NUMHI]`                                                                                                                                                                                                                         | `t`: table.                                                                                                                                                                                                                                                                        | `any[]` (list of values)                                                                                                                      | `vim.tbl_values({a=1,b=2})` -> `{1,2}` (order may vary). `[NUMHI]`                                                                                                                    |
|                                         | `vim.trim(s)`                                      | Trims whitespace (Lua pattern `%s`) from both sides of string `s`.                                                                                                                                                                                                                                | `s`: string.                                                                                                                                                                                                                                                                       | `string`                                                                                                                                      | `vim.trim("  hello  ")` -> `"hello"`.                                                                                                                                                 |
|                                         | `vim.validate(name,val,valid,opt?,msg?)`           | Validates function arguments. Form 1: single arg. Form 2 (deprecated): spec table. `[NUMHI]`                                                                                                                                                                                                      | `name`: str. `value`: any. `validator`: str (type name like 'string', 'table', 'callable') or `string[]` or `fun(val):bool,str?`. `optional?`: bool. `message?`: str. Validator value from `lua-type()` is best performance.                                                       | N/A (throws error on failure)                                                                                                                 | `vim.validate('count', 10, 'number')`. `vim.validate('cb', myfn, 'function', true)`. `[NUMHI]`                                                                                        |
| **Lua module: `vim.loader`**            | `vim.loader.enable(enable?)`                       | **Experimental**. Enables/disables experimental Lua module loader (overrides `loadfile`, adds byte-compilation cache & libs loader, removes Nvim default loader).                                                                                                                                 | `enable`: boolean? (true/nil to enable, false to disable).                                                                                                                                                                                                                         | N/A                                                                                                                                           | For potentially faster plugin loading.                                                                                                                                                |
|                                         | `vim.loader.find(mod, opts?)`                      | **Experimental**. Finds Lua modules for `modname`. `modname="*"` for top-level.                                                                                                                                                                                                                   | `opts`: `{rtp=bool(T), paths=str[]({}), patterns=str[]({"/init.lua",".lua"}), all=bool(F)}`.                                                                                                                                                                                       | `table[]` (list of `{modpath, modname, stat}` objects)                                                                                        | Advanced module loading introspection.                                                                                                                                                |
|                                         | `vim.loader.reset(path?)`                          | **Experimental**. Resets cache for `path` (or all if `path` is nil).                                                                                                                                                                                                                              | `path`: string?.                                                                                                                                                                                                                                                                   | N/A                                                                                                                                           |                                                                                                                                                                                       |
| **Lua module: `vim.uri`**               | `vim.uri_decode(str)`                              | URI-decodes string with percent escapes.                                                                                                                                                                                                                                                          | `str`: string to decode.                                                                                                                                                                                                                                                           | `string` (decoded)                                                                                                                            |                                                                                                                                                                                       |
|                                         | `vim.uri_encode(str, rfc?)`                        | URI-encodes string using percent escapes.                                                                                                                                                                                                                                                         | `str`: string to encode. `rfc`: "rfc2396"                                                                                                                                                                                                                                          | "rfc2732"                                                                                                                                     | "rfc3986"?.                                                                                                                                                                           | `string` (encoded)                                                 |                                                   |
|                                         | `vim.uri_from_bufnr(bufnr)`                        | Gets URI from `bufnr`.                                                                                                                                                                                                                                                                            | `bufnr`: integer.                                                                                                                                                                                                                                                                  | `string` (URI)                                                                                                                                | For LSP or other tools using URIs.                                                                                                                                                    |
|                                         | `vim.uri_from_fname(path)`                         | Gets URI from file path.                                                                                                                                                                                                                                                                          | `path`: string.                                                                                                                                                                                                                                                                    | `string` (URI)                                                                                                                                | For LSP or other tools using URIs.                                                                                                                                                    |
|                                         | `vim.uri_to_bufnr(uri)`                            | Gets buffer for URI. Creates new unloaded buffer if DNE.                                                                                                                                                                                                                                          | `uri`: string.                                                                                                                                                                                                                                                                     | `integer` (bufnr)                                                                                                                             | For LSP or other tools using URIs.                                                                                                                                                    |
|                                         | `vim.uri_to_fname(uri)`                            | Gets filename from URI. Returns URI unchanged for non-file URIs.                                                                                                                                                                                                                                  | `uri`: string.                                                                                                                                                                                                                                                                     | `string` (filename or URI)                                                                                                                    | For LSP or other tools using URIs.                                                                                                                                                    |
| **Lua module: `vim.ui`**                | `vim.ui.input(opts, on_confirm)`                   | Prompts user for input. `[NUMHI]`                                                                                                                                                                                                                                                                 | `opts`: `{prompt=str?, default=str?, completion=str?, highlight=fun}`. `on_confirm`: `fun((input                                                                                                                                                                                   | nil) -> ())`.                                                                                                                                 | N/A                                                                                                                                                                                   | `vim.ui.input({prompt="Name: "}, cb)`. `[NUMHI]`                   |
|                                         | `vim.ui.open(path, opt?)`                          | Opens `path` with system default handler (xdg-open, etc.). Expands `~/`, env vars. Returns error msg on failure. `:Open` cmd.                                                                                                                                                                     | `path`: string. `opt`: `{cmd?: string[]}` (custom command). Asynchronous by default. `cmd:wait()` for synchronous.                                                                                                                                                                 | `vim.SystemObj?`, `string?` (cmd object or nil, error message or nil)                                                                         | `vim.ui.open("~/doc.pdf")`                                                                                                                                                            |
|                                         | `vim.ui.select(items, opts, on_choice)`            | Prompts user to pick from list. `[NUMHI]`                                                                                                                                                                                                                                                         | `items`: `any[]`. `opts`: `{prompt=str?, format_item=fun(item)->text, kind=str?}`. `on_choice`: `fun(item:T?, idx:integer?)`.                                                                                                                                                      | N/A                                                                                                                                           | `vim.ui.select({'a','b'}, {prompt="Choose:"}, cb)`. `[NUMHI]`                                                                                                                         |
| **Lua module: `vim._extui`**            | `vim._extui.enable(opts?)`                         | **Experimental**. Enables/disables experimental UI message handling (replaces TUI message grid).                                                                                                                                                                                                  | `opts`: `{enable=bool, msg={pos='cmd'                                                                                                                                                                                                                                              | 'box', box={timeout=ms}}}`. Uses "cmd", "box", "more", "prompt" window types with specific filetypes. `[+x]`spill indicator.`g<` to see full. | N/A                                                                                                                                                                                   | For cmdheight=0 and alternative message display.                   |
| **Lua module: `vim.filetype`**          | `vim.filetype.add(filetypes)`                      | Add new filetype mappings by extension, filename, or pattern (Lua pattern or function). `[NUMHI]`                                                                                                                                                                                                 | `filetypes`: table with `extension`, `filename`, `pattern` sub-tables. Pattern can have `priority`. Function can return `ft_string` or `ft_string, post_set_fn(bufnr)`. Env vars `"${VAR}"` expanded in patterns.                                                                  | N/A                                                                                                                                           | `vim.filetype.add({extension={foo='fooscript'}})`. `[NUMHI]`                                                                                                                          |
|                                         | `vim.filetype.get_option(ft, opt)`                 | Get default option value for `filetype`. Respects FileType autocmds/ftplugins. Caches result. Since 0.9.0.                                                                                                                                                                                        | `filetype`: string. `option`: string.                                                                                                                                                                                                                                              | `string                                                                                                                                       | boolean                                                                                                                                                                               | integer` (option value)                                            | `vim.filetype.get_option('vim', 'commentstring')` |
|                                         | `vim.filetype.match(args)`                         | Perform filetype detection using buffer, filename, or contents. `[NUMHI]`                                                                                                                                                                                                                         | `args`: `{buf=int?, filename=str?, contents=str[]?}`. Mutually exclusive: `buf` and `contents`.                                                                                                                                                                                    | `string?`, `function?` (matched filetype, buffer modification function)                                                                       | `vim.filetype.match({filename='main.lua'})`. `[NUMHI]`                                                                                                                                |
| **Lua module: `vim.keymap`**            | `vim.keymap.del(modes, lhs, opts?)`                | Remove mapping. `[NUMHI]`                                                                                                                                                                                                                                                                         | `modes`: `string` or `string[]`. `lhs`: string. `opts`: `{buffer=int                                                                                                                                                                                                               | bool}` (0 or true for current).                                                                                                               | N/A                                                                                                                                                                                   | `vim.keymap.del('n', '<leader>x', {buffer=true})`. `[NUMHI]`       |
|                                         | `vim.keymap.set(mode,lhs,rhs,opts?)`               | Defines mapping. `rhs` can be Lua function. `[NUMHI]`                                                                                                                                                                                                                                             | `mode`: `string` or `string[]`. `lhs, rhs`: strings. `opts`: same as `nvim_set_keymap` plus `{buffer=int                                                                                                                                                                           | bool, remap=bool (def false, inverse of noremap)}`. `replace_keycodes`def true if`expr` is true.                                              | N/A                                                                                                                                                                                   | `vim.keymap.set('n', 'gx', function() print("Hi") end)`. `[NUMHI]` |
| **Lua module: `vim.fs`**                | `vim.fs.abspath(path)`                             | Convert path to absolute. Expands `~`. No exist check, normalize, symlink resolve. Converts `\` to `/`. `[NUMHI]`                                                                                                                                                                                 | `path`: string.                                                                                                                                                                                                                                                                    | `string` (absolute path)                                                                                                                      | `vim.fs.abspath("~/file")`. `[NUMHI]`                                                                                                                                                 |
|                                         | `vim.fs.basename(file?)`                           | Return basename of path. Since 0.8.0. `[NUMHI]`                                                                                                                                                                                                                                                   | `file`: string?.                                                                                                                                                                                                                                                                   | `string?`                                                                                                                                     | `vim.fs.basename("/usr/local/bin/nvim")` -> `"nvim"`. `[NUMHI]`                                                                                                                       |
|                                         | `vim.fs.dir(path, opts?)`                          | Iterator over items in `path`. Since 0.8.0.                                                                                                                                                                                                                                                       | `path`: string. `opts`: `{depth=int?, skip=fun(dir):bool?, follow=bool?}`. Yields `name` (relative to `path`), `type` ("file", "directory", etc.).                                                                                                                                 | `Iterator`                                                                                                                                    | `for name, type in vim.fs.dir("./lua") do ... end`                                                                                                                                    |
|                                         | `vim.fs.dirname(file?)`                            | Gets parent directory of path (not expanded/resolved). Since 0.8.0. `[NUMHI]`                                                                                                                                                                                                                     | `file`: string?.                                                                                                                                                                                                                                                                   | `string?`                                                                                                                                     | `vim.fs.dirname("/usr/local/bin/nvim")` -> `"/usr/local/bin"`. `[NUMHI]`                                                                                                              |
|                                         | `vim.fs.find(names, opts)`                         | Find files/dirs. `names`: str, str[], or `fn(name,path):bool`. `opts`: `path`(def cwd), `upward`(F), `stop`, `type`, `limit`(1), `follow`(F). Since 0.8.0. `[NUMHI]`                                                                                                                              |                                                                                                                                                                                                                                                                                    | `string[]` (normalized paths)                                                                                                                 | `vim.fs.find("init.lua", {path=".", upward=true, limit=1})`. `[NUMHI]`                                                                                                                |
|                                         | `vim.fs.joinpath(...)`                             | Concatenates path parts. Normalizes slashes (redundant removed, `\` to `/` on Win). Since 0.10.0. `[NUMHI]`                                                                                                                                                                                       | `...`: strings.                                                                                                                                                                                                                                                                    | `string`                                                                                                                                      | `vim.fs.joinpath("foo/", "/bar")` -> `"foo/bar"`. `[NUMHI]`                                                                                                                           |
|                                         | `vim.fs.normalize(path, opts?)`                    | Normalize path: expands `~`, env vars, resolves `.` `..` (except relative leading to absolute). `\` to `/` on Win. Since 0.8.0. `[NUMHI]`                                                                                                                                                         | `opts`: `{expand_env=bool(T), win=bool(OS-default)}`.                                                                                                                                                                                                                              | `string` (normalized path)                                                                                                                    | `vim.fs.normalize("~/src/../mydir")`. `[NUMHI]`                                                                                                                                       |
|                                         | `vim.fs.parents(start)`                            | Iterator over all parent directories of `start` (not expanded/resolved). Since 0.8.0. `[NUMHI]`                                                                                                                                                                                                   | `start`: string.                                                                                                                                                                                                                                                                   | `fun()`, `nil`, `string?` (iterator)                                                                                                          | `for dir in vim.fs.parents(bufname) do ... end`. `[NUMHI]`                                                                                                                            |
|                                         | `vim.fs.relpath(base, target, opts?)`              | Gets `target` path relative to `base`. Returns `nil` if `base` not ancestor.                                                                                                                                                                                                                      | `base, target`: strings. `opts`: reserved.                                                                                                                                                                                                                                         | `string?`                                                                                                                                     | `vim.fs.relpath('/var', '/var/lib')` -> `'lib'`.                                                                                                                                      |
|                                         | `vim.fs.rm(path, opts?)`                           | Remove files or directories. Since 0.11.0. `[NUMHI]`                                                                                                                                                                                                                                              | `path`: string. `opts`: `{recursive=bool, force=bool}`.                                                                                                                                                                                                                            | N/A                                                                                                                                           | `vim.fs.rm("oldfile.txt", {force=true})`. `[NUMHI]`                                                                                                                                   |
|                                         | `vim.fs.root(source, marker)`                      | Find first parent dir containing `marker`. `source`: buf or path. If unnamed buf or non-empty `buftype`, uses cwd. Since 0.10.0. `[NUMHI]`                                                                                                                                                        | `marker`: `string` or `string[]` or `fun(name,path):bool`.                                                                                                                                                                                                                         | `string?` (directory path or nil)                                                                                                             | `vim.fs.root(0, '.git')`. `[NUMHI]`                                                                                                                                                   |
| **Lua module: `vim.glob`**              | `vim.glob.to_lpeg(pattern)`                        | Parses raw glob `pattern` into an [lua-lpeg]() pattern. LSP 3.17.0 glob syntax (`*`, `?`, `**`, `{}`, `[]`, `[!...]`).                                                                                                                                                                            | `pattern`: string.                                                                                                                                                                                                                                                                 | `vim.lpeg.Pattern`                                                                                                                            | For advanced file searching/filtering using glob patterns.                                                                                                                            |
| **`VIM.LPEG`**                          | `vim.lpeg`                                         | LPeg pattern-matching library (Parsing Expression Grammars). `[NUMHI]`                                                                                                                                                                                                                            | See [LPeg docs](https://www.inf.puc-rio.br/~roberto/lpeg/).                                                                                                                                                                                                                        | LPeg objects                                                                                                                                  | `local lpeg = vim.lpeg`. `[NUMHI]`                                                                                                                                                    |
|                                         | `Pattern:match(subj, init?, ...)`                  | Matches pattern against `subject` string (anchored). `[NUMHI]`                                                                                                                                                                                                                                    | `subject`: string. `init`: integer? (start position). `...`: extra args for `Carg`.                                                                                                                                                                                                | `integer?` (index after match) or captured values                                                                                             | `lpeg.R('az')^1 * -1 :match('hello')` -> 6. `[NUMHI]`                                                                                                                                 |
|                                         | `vim.lpeg.B(pattern)`                              | Pattern matches if current position preceded by `patt` (fixed length, no captures). Does not consume input.                                                                                                                                                                                       | `pattern`: lpeg pattern convertible.                                                                                                                                                                                                                                               | `vim.lpeg.Pattern`                                                                                                                            | Lookbehind assertion.                                                                                                                                                                 |
|                                         | `vim.lpeg.C(patt)`                                 | Simple capture: captures substring matching `patt`. `[NUMHI]`                                                                                                                                                                                                                                     | `patt`: lpeg pattern convertible or function.                                                                                                                                                                                                                                      | `vim.lpeg.Capture` (produces string)                                                                                                          | `lpeg.C((1 - lpeg.P(","))^0)` captures text up to a comma. `[NUMHI]`                                                                                                                  |
|                                         | `vim.lpeg.Carg(n)`                                 | Argument capture: matches empty, produces n-th extra arg to `lpeg.match`.                                                                                                                                                                                                                         | `n`: integer.                                                                                                                                                                                                                                                                      | `vim.lpeg.Capture`                                                                                                                            |                                                                                                                                                                                       |
|                                         | `vim.lpeg.Cb(name)`                                | Back capture: matches empty, produces values from most recent group capture named `name`.                                                                                                                                                                                                         | `name`: any Lua value.                                                                                                                                                                                                                                                             | `vim.lpeg.Capture`                                                                                                                            | `patt = lpeg.Cg(lpeg.P"foo", "tag") * lpeg.P"bar" * lpeg.Cb("tag")`                                                                                                                   |
|                                         | `vim.lpeg.Cc(...)`                                 | Constant capture: matches empty, produces given values.                                                                                                                                                                                                                                           | `...`: any values.                                                                                                                                                                                                                                                                 | `vim.lpeg.Capture`                                                                                                                            | `lpeg.Cc(1, "str")`                                                                                                                                                                   |
|                                         | `vim.lpeg.Cf(patt, func)`                          | Fold capture: accumulates captures from `patt` using `func(accumulator, capture_values...)`. `[NUMHI]`                                                                                                                                                                                            | `patt`: pattern. `func`: function. `patt` must produce at least one value.                                                                                                                                                                                                         | `vim.lpeg.Capture`                                                                                                                            | `sum = lpeg.Cf(lpeg.R('09')^1 / tonumber * (',' * lpeg.R('09')^1 / tonumber)^0, function(a,b) return a+b end)`. `[NUMHI]`                                                             |
|                                         | `vim.lpeg.Cg(patt, name?)`                         | Group capture: groups values from `patt` into single capture, optionally named.                                                                                                                                                                                                                   | `patt`: pattern. `name`: string?.                                                                                                                                                                                                                                                  | `vim.lpeg.Capture`                                                                                                                            | `lpeg.Cg(lpeg.C(lpeg.P"a") * lpeg.C(lpeg.P"b"))` captures "a", "b" as one group.                                                                                                      |
|                                         | `vim.lpeg.Cmt(patt, fn)`                           | Match-time capture: `fn(subject, pos, captures...)` called immediately on `patt` match. `fn` return defines match success/new position.                                                                                                                                                           | `patt`: pattern. `fn`: function. Return number for new pos, true for no consumption, false/nil for fail. Extra returns from `fn` are captures.                                                                                                                                     | `vim.lpeg.Capture`                                                                                                                            | For complex stateful parsing or immediate side effects.                                                                                                                               |
|                                         | `vim.lpeg.Cp()`                                    | Position capture: matches empty, captures current subject position. `[NUMHI]`                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                    | `vim.lpeg.Capture` (produces number)                                                                                                          | `lpeg.Cp() * lpeg.P"text" * lpeg.Cp()` captures start and end positions. `[NUMHI]`                                                                                                    |
|                                         | `vim.lpeg.Cs(patt)`                                | Substitution capture: captures substring matching `patt`, replacing inner captures with their string values. `[NUMHI]`                                                                                                                                                                            | `patt`: pattern.                                                                                                                                                                                                                                                                   | `vim.lpeg.Capture` (produces string)                                                                                                          | `lpeg.Cs( (lpeg.P('x') / 'y')^0 )` replaces all 'x' with 'y'. `[NUMHI]`                                                                                                               |
|                                         | `vim.lpeg.Ct(patt)`                                | Table capture: anonymous captures from `patt` into array part of table, named captures into hash part. `[NUMHI]`                                                                                                                                                                                  | `patt`: pattern.                                                                                                                                                                                                                                                                   | `vim.lpeg.Capture` (produces table)                                                                                                           | `lpeg.Ct(lpeg.Cg(lpeg.C(word), "key") * "=" * lpeg.Cg(lpeg.C(word), "val"))` builds `{key="k", val="v"}`. `[NUMHI]`                                                                   |
|                                         | `vim.lpeg.locale(tab?)`                            | Returns/populates table with locale-specific char class patterns (`alnum`, `alpha`, etc.).                                                                                                                                                                                                        | `tab`: table? (optional table to populate).                                                                                                                                                                                                                                        | `vim.lpeg.Locale` (table of patterns)                                                                                                         | `local locale = lpeg.locale(); local digit = locale.digit`.                                                                                                                           |
|                                         | `vim.lpeg.match(patt, subj, ...)`                  | Same as `Pattern:match()`. `[NUMHI]`                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                    |                                                                                                                                               |                                                                                                                                                                                       |
|                                         | `vim.lpeg.P(value)`                                | Converts value to pattern: string->literal, num->n chars, bool->always fail/succeed, table->grammar, func->match-time capture. `[NUMHI]`                                                                                                                                                          | `value`: pattern convertible.                                                                                                                                                                                                                                                      | `vim.lpeg.Pattern`                                                                                                                            | `lpeg.P"abc"`, `lpeg.P(5)`, `lpeg.P(true)`. `[NUMHI]`                                                                                                                                 |
|                                         | `vim.lpeg.R(...)`                                  | Pattern matches single char in given ranges (`'xy'` string for char code x to y). `[NUMHI]`                                                                                                                                                                                                       | `...`: string ranges.                                                                                                                                                                                                                                                              | `vim.lpeg.Pattern`                                                                                                                            | `lpeg.R('09', 'az')` matches digit or lowercase letter. `[NUMHI]`                                                                                                                     |
|                                         | `vim.lpeg.S(string)`                               | Pattern matches single char in the set of chars in `string`. `[NUMHI]`                                                                                                                                                                                                                            | `string`: string of chars.                                                                                                                                                                                                                                                         | `vim.lpeg.Pattern`                                                                                                                            | `lpeg.S("+-*/")` matches an operator. `[NUMHI]`                                                                                                                                       |
|                                         | `vim.lpeg.setmaxstack(max)`                        | Sets limit for LPeg backtrack stack size (default 400).                                                                                                                                                                                                                                           | `max`: integer.                                                                                                                                                                                                                                                                    | N/A                                                                                                                                           | Adjust if complex patterns or deep recursion cause overflow.                                                                                                                          |
|                                         | `vim.lpeg.type(value)`                             | Returns "pattern" if `value` is LPeg pattern, else `nil`.                                                                                                                                                                                                                                         | `value`: any.                                                                                                                                                                                                                                                                      | `"pattern"?`                                                                                                                                  | `if lpeg.type(p) == "pattern" then ... end`.                                                                                                                                          |
|                                         | `vim.lpeg.V(v)`                                    | Creates non-terminal (variable) for a grammar, referring to rule indexed by `v`. `[NUMHI]`                                                                                                                                                                                                        | `v`: any (grammar rule index).                                                                                                                                                                                                                                                     | `vim.lpeg.Pattern`                                                                                                                            | `grammar = { lpeg.V(1) * "a" }` (rule 1 refers to itself). `[NUMHI]`                                                                                                                  |
|                                         | `vim.lpeg.version()`                               | Returns LPeg version string.                                                                                                                                                                                                                                                                      |                                                                                                                                                                                                                                                                                    | `string`                                                                                                                                      |                                                                                                                                                                                       |
| **`VIM.RE`**                            | `vim.re`                                           | Conventional regex-like syntax for LPeg. Unrelated to `vim.regex` (Vim regexp). `[NUMHI]`                                                                                                                                                                                                         | See [re.lua docs](https://www.inf.puc-rio.br/~roberto/lpeg/re.html).                                                                                                                                                                                                               | `vim.lpeg.Pattern` or match results                                                                                                           | `local re = vim.re`. `[NUMHI]`                                                                                                                                                        |
|                                         | `vim.re.compile(str, defs?)`                       | Compiles regex `str` (expr or grammar) to LPeg pattern. `defs` for extra Lua values. `[NUMHI]`                                                                                                                                                                                                    | `str`: string. `defs`: table?.                                                                                                                                                                                                                                                     | `vim.lpeg.Pattern`                                                                                                                            | `local p = vim.re.compile("foo%d*bar")`. `[NUMHI]`                                                                                                                                    |
|                                         | `vim.re.find(subj, patt, init?)`                   | Searches `patt` in `subj`. Returns start/end indices or nil. `[NUMHI]`                                                                                                                                                                                                                            | `subj`: string. `patt`: pattern or string. `init`: integer?.                                                                                                                                                                                                                       | `integer?`, `integer?` (start, end or nil, nil)                                                                                               | `local s, e = vim.re.find("text", "ex")`. `[NUMHI]`                                                                                                                                   |
|                                         | `vim.re.gsub(subj, patt, repl)`                    | Global substitution: replaces all `patt` in `subj` with `repl`. `[NUMHI]`                                                                                                                                                                                                                         | `subj, patt, repl`: strings. `patt` can be pattern.                                                                                                                                                                                                                                | `string`                                                                                                                                      | `vim.re.gsub("hello", "l", "L")` -> "heLLo". `[NUMHI]`                                                                                                                                |
|                                         | `vim.re.match(subj, patt, init?)`                  | Matches `patt` against `subj`, returns all captures. `[NUMHI]`                                                                                                                                                                                                                                    | `subj`: string. `patt`: pattern or string. `init`: integer?.                                                                                                                                                                                                                       | `integer` or `vim.lpeg.Capture?`                                                                                                              | `local cap = vim.re.match("foo123", "(%a+)(%d+)")`. `[NUMHI]`                                                                                                                         |
|                                         | `vim.re.updatelocale()`                            | Updates pre-defined char classes (e.g., `%a`, `%d`) to current locale.                                                                                                                                                                                                                            |                                                                                                                                                                                                                                                                                    | N/A                                                                                                                                           | Call if locale changes during Nvim session and regexes depend on it.                                                                                                                  |
| **`VIM.REGEX`**                         | `vim.regex(re)`                                    | Parses Vim regex `re`, returns regex object. Magic/case-sensitive by default (`\c`, `\m` flags). `[NUMHI]`                                                                                                                                                                                        | `re`: string.                                                                                                                                                                                                                                                                      | `vim.regex` object                                                                                                                            | `local r = vim.regex('\\<word\\>')`. `[NUMHI]`                                                                                                                                        |
|                                         | `regex:match_line(buf,ln,s,e)`                     | Matches line `ln` (0-idx) in `buf`. Range `s` to `e` (byte idx). Indices relative to `s`. `[NUMHI]`                                                                                                                                                                                               | `bufnr, line_idx`: integers. `start?, end_?`: integers.                                                                                                                                                                                                                            | `integer?`, `integer?` (match start, end rel. to `start`, or nil, nil)                                                                        | For matching directly against buffer lines.                                                                                                                                           |
|                                         | `regex:match_str(str)`                             | Matches string `str`. Use `^` `$` for precise. Returns start/end byte indices or nil. `[NUMHI]`                                                                                                                                                                                                   | `str`: string.                                                                                                                                                                                                                                                                     | `integer?`, `integer?` (match start, end, or nil, nil)                                                                                        | `if my_regex:match_str(line) then ... end`. `[NUMHI]`                                                                                                                                 |
| **Lua module: `vim.secure`**            | `vim.secure.read(path)`                            | Reads file if trusted, or checks dir trust (non-recursive). Prompts user. Persists choice in `$XDG_STATE_HOME/nvim/trust`. Since 0.9.0. `[NUMHI]`                                                                                                                                                 | `path`: string.                                                                                                                                                                                                                                                                    | `boolean` (for dir) or `string?` (file content) or `nil` (not trusted/DNE)                                                                    | `local content = vim.secure.read("./project_config.lua")`. `[NUMHI]`                                                                                                                  |
|                                         | `vim.secure.trust(opts)`                           | Manages trust database. Since 0.9.0.                                                                                                                                                                                                                                                              | `opts`: `{action='allow'                                                                                                                                                                                                                                                           | 'deny'                                                                                                                                        | 'remove', path=str XOR bufnr=int}`. `path`cannot be used with`action='allow'`.                                                                                                        | `boolean` (success), `string` (path or error message)              | For explicitly managing file trust.               |
| **Lua module: `vim.version`**           | `vim.version`                                      | Module for comparing semver versions/ranges. `vim.version()` is current Nvim version object. Since 0.9.0. `[NUMHI]`                                                                                                                                                                               | Versions are `{major,minor,patch,prerelease?,build?}` tables.                                                                                                                                                                                                                      |                                                                                                                                               | `if vim.version.gt(vim.version(), {0,9,0}) then ... end`. `[NUMHI]`                                                                                                                   |
|                                         | `version-range` spec                               | Defines semver range: `1.2.3`, `=1.2.3`, `>1.2.3`, `<1.2.3`, `>=1.2.3`, `~1.2.3` (patch), `^1.2.3` (minor), `1.x`, `*`, `1.2.3 - 2.3.4`. Partial versions have specific handling. `[NUMHI]`                                                                                                       | Suffixed versions (e.g. 1.2.3-rc1) not matched by ranges.                                                                                                                                                                                                                          | N/A                                                                                                                                           | Used with `vim.version.range()`. `[NUMHI]`                                                                                                                                            |
|                                         | `vim.version.cmp(v1, v2)`                          | Parses and compares two version objects or strings/tuples. Build metadata ignored. Since 0.9.0. `[NUMHI]`                                                                                                                                                                                         | `v1, v2`: `vim.Version` or `number[]` or `string`.                                                                                                                                                                                                                                 | `integer` (-1 if v1<v2, 0 if v1==v2, 1 if v1>v2)                                                                                              | `vim.version.cmp({1,0,3}, "0.2.1")`. `[NUMHI]`                                                                                                                                        |
|                                         | `vim.version.eq/ge/gt/le/lt`                       | Boolean comparison functions based on `cmp`. Since 0.9.0 / 0.10.0. `[NUMHI]`                                                                                                                                                                                                                      | `v1, v2`: `vim.Version` or `number[]` or `string`.                                                                                                                                                                                                                                 | `boolean`                                                                                                                                     | `vim.version.eq("1.0", {1,0,0})`. `[NUMHI]`                                                                                                                                           |
|                                         | `vim.version.last(versions)`                       | TODO: generalize this. (From doc, seems incomplete).                                                                                                                                                                                                                                              | `versions`: `vim.Version[]`.                                                                                                                                                                                                                                                       | `vim.Version?`                                                                                                                                |                                                                                                                                                                                       |
|                                         | `vim.version.parse(ver, opts?)`                    | Parses semver string to version object. Since 0.9.0. `[NUMHI]`                                                                                                                                                                                                                                    | `version`: string. `opts`: `{strict=bool(F)}`. `strict=false` coerces e.g. "1.0", "tmux 3.2a".                                                                                                                                                                                     | `vim.Version?` (object or nil)                                                                                                                | `vim.version.parse("1.0.1-rc1+b.2")`. `[NUMHI]`                                                                                                                                       |
|                                         | `vim.version.range(spec)`                          | Parses semver range `spec`, returns range object with `from`, `to` (Version objs) and `has(v)` method. Since 0.9.0. `[NUMHI]`                                                                                                                                                                     | `spec`: string. `has(v)` checks if `v` is in range (`from` inclusive, `to` exclusive).                                                                                                                                                                                             | `table?` (range object or nil)                                                                                                                | `local r = vim.version.range('~1.2'); if r:has("1.2.5") then ... end`. `[NUMHI]`                                                                                                      |
| **Lua module: `vim.iter`**              | `vim.iter(iterable)`                               | Wraps table/function into `Iter` object with chainable methods. Lists yield values; dicts yield key,value. Scans table input to detect type. `[NUMHI]`                                                                                                                                            | `iterable`: table, function, `__call` table, `vim.iter` obj. Holes in lists allowed but discarded. Use `pairs()` for dict-like list iteration. `ipairs()` for index,value.                                                                                                         | `Iter` object                                                                                                                                 | `vim.iter({1,2,3}):map(fn):totable()`. `[NUMHI]`                                                                                                                                      |
|                                         | `Iter:all(pred)`                                   | True if all items match predicate `pred(values...)`. `[NUMHI]`                                                                                                                                                                                                                                    | `pred`: `fun(...):boolean`.                                                                                                                                                                                                                                                        | `boolean`                                                                                                                                     | `iter:all(function(x) return x > 0 end)`. `[NUMHI]`                                                                                                                                   |
|                                         | `Iter:any(pred)`                                   | True if any item matches predicate `pred(values...)`. `[NUMHI]`                                                                                                                                                                                                                                   | `pred`: `fun(...):boolean`.                                                                                                                                                                                                                                                        | `boolean`                                                                                                                                     | `iter:any(function(k,v) return k == 'key' end)`. `[NUMHI]`                                                                                                                            |
|                                         | `Iter:each(f)`                                     | Calls `f(values...)` for each item, drains iterator. For side effects. `[NUMHI]`                                                                                                                                                                                                                  | `f`: `fun(...)`.                                                                                                                                                                                                                                                                   | N/A                                                                                                                                           | `iter:each(print)`. `[NUMHI]`                                                                                                                                                         |
|                                         | `Iter:enumerate()`                                 | Yields item index (count) and value(s) for each item. `[NUMHI]`                                                                                                                                                                                                                                   | For list tables, `vim.iter(ipairs(t))` is more efficient.                                                                                                                                                                                                                          | `Iter`                                                                                                                                        | `vim.iter({'a','b'}):enumerate()` yields `1,'a'`, then `2,'b'`. `[NUMHI]`                                                                                                             |
|                                         | `Iter:filter(f)`                                   | Filters pipeline. `f(values...)` returning false/nil removes item. `[NUMHI]`                                                                                                                                                                                                                      | `f`: `fun(...):boolean`.                                                                                                                                                                                                                                                           | `Iter`                                                                                                                                        | `iter:filter(vim.api.nvim_buf_is_loaded)`. `[NUMHI]`                                                                                                                                  |
|                                         | `Iter:find(f)`                                     | Find first value satisfying predicate `f` (or equal to `f` if not function). Advances iterator. Drains if not found. `[NUMHI]`                                                                                                                                                                    | `f`: `any` or `fun(...)`.                                                                                                                                                                                                                                                          | `any` (found value or `nil`)                                                                                                                  | `iter:find(12)` or `iter:find(function(v) return v > 10 end)`. `[NUMHI]`                                                                                                              |
|                                         | `Iter:flatten(depth?)`                             | Flattens [list-iterator](), un-nesting up to `depth` (def 1). Errors on dict-like. `[NUMHI]`                                                                                                                                                                                                      | `depth`: `number?`.                                                                                                                                                                                                                                                                | `Iter`                                                                                                                                        | `vim.iter({1,{2},{{3}}}):flatten():totable()` -> `{1,2,{3}}`. `[NUMHI]`                                                                                                               |
|                                         | `Iter:fold(init, f)`                               | Folds/reduces iterator. `f(accumulator, values...)`. `[NUMHI]`                                                                                                                                                                                                                                    | `init`: `any`. `f`: `fun(acc, ...):acc`.                                                                                                                                                                                                                                           | `any` (final accumulator value)                                                                                                               | `iter:fold(0, function(sum, v) return sum + v end)`. `[NUMHI]`                                                                                                                        |
|                                         | `Iter:join(delim)`                                 | Collects iterator into string delimited by `delim`. Consumes iterator.                                                                                                                                                                                                                            | `delim`: string.                                                                                                                                                                                                                                                                   | `string`                                                                                                                                      | `vim.iter({'a','b'}):join(',')` -> `"a,b"`.                                                                                                                                           |
|                                         | `Iter:last()`                                      | Drains iterator, returns last item. `[NUMHI]`                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                    | `any`                                                                                                                                         | `vim.iter({1,2,3}):last()` -> 3. `[NUMHI]`                                                                                                                                            |
|                                         | `Iter:map(f)`                                      | Maps items to values from `f(values...)`. Nil return filters item. `[NUMHI]`                                                                                                                                                                                                                      | `f`: `fun(...):...:any`.                                                                                                                                                                                                                                                           | `Iter`                                                                                                                                        | `iter:map(function(v) return v*2 end)`. `[NUMHI]`                                                                                                                                     |
|                                         | `Iter:next()`                                      | Gets next value(s) from iterator. `[NUMHI]`                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                    | `any` (values or `nil` if exhausted)                                                                                                          | `local val = iter:next()`. `[NUMHI]`                                                                                                                                                  |
|                                         | `Iter:nth(n)`                                      | Gets n-th value, advances. Negative `n` for [list-iterator]() offsets from end. `[NUMHI]`                                                                                                                                                                                                         | `n`: `number`.                                                                                                                                                                                                                                                                     | `any`                                                                                                                                         | `iter:nth(2)` gets second item. `iter:nth(-1)` gets last. `[NUMHI]`                                                                                                                   |
|                                         | `Iter:peek()`                                      | Gets next value in [list-iterator]() without consuming it. `[NUMHI]`                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                    | `any`                                                                                                                                         | `local next_val = iter:peek()`. `[NUMHI]`                                                                                                                                             |
|                                         | `Iter:pop()`                                       | "Pops" last value from [list-iterator](), decrements tail. `[NUMHI]`                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                    | `any`                                                                                                                                         | `local last_val = iter:pop()`. `[NUMHI]`                                                                                                                                              |
|                                         | `Iter:rev()`                                       | Reverses [list-iterator]() pipeline. `[NUMHI]`                                                                                                                                                                                                                                                    |                                                                                                                                                                                                                                                                                    | `Iter`                                                                                                                                        | `vim.iter({1,2,3}):rev():totable()` -> `{3,2,1}`. `[NUMHI]`                                                                                                                           |
|                                         | `Iter:rfind(f)`                                    | Gets first value satisfying predicate `f` from end of [list-iterator](). Advances.                                                                                                                                                                                                                | `f`: `any` or `fun(...)`.                                                                                                                                                                                                                                                          | `any`                                                                                                                                         |                                                                                                                                                                                       |
|                                         | `Iter:rpeek()`                                     | Gets last value of [list-iterator]() without consuming it. `[NUMHI]`                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                    | `any`                                                                                                                                         |                                                                                                                                                                                       |
|                                         | `Iter:rskip(n)`                                    | Discards `n` values from end of [list-iterator]() pipeline. `[NUMHI]`                                                                                                                                                                                                                             | `n`: `number`.                                                                                                                                                                                                                                                                     | `Iter`                                                                                                                                        |                                                                                                                                                                                       |
|                                         | `Iter:skip(n)`                                     | Skips `n` values of iterator pipeline. `[NUMHI]`                                                                                                                                                                                                                                                  | `n`: `number`.                                                                                                                                                                                                                                                                     | `Iter`                                                                                                                                        | `iter:skip(2)`. `[NUMHI]`                                                                                                                                                             |
|                                         | `Iter:slice(first, last)`                          | Sets start/end of [list-iterator]() pipeline. Like `:skip(first-1):rskip(len-last+1)`.                                                                                                                                                                                                            | `first, last`: numbers.                                                                                                                                                                                                                                                            | `Iter`                                                                                                                                        |                                                                                                                                                                                       |
|                                         | `Iter:take(n)`                                     | Transforms iterator to yield only first `n` values.                                                                                                                                                                                                                                               | `n`: integer.                                                                                                                                                                                                                                                                      | `Iter`                                                                                                                                        | `iter:take(5)`.                                                                                                                                                                       |
|                                         | `Iter:totable()`                                   | Collects iterator into a table. Array-like tables/func iterators -> array-like table. Multiple return values -> table of tables. `[NUMHI]`                                                                                                                                                        | To create map-like table, use `Iter:fold()`.                                                                                                                                                                                                                                       | `table`                                                                                                                                       | `iter:map(tonumber):totable()`. `[NUMHI]`                                                                                                                                             |
| **Lua module: `vim.snippet`**           | `vim.snippet.ActiveFilter`                         | Filter for `vim.snippet.active()`: `{direction = vim.snippet.Direction}` (-1 prev, 1 next).                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                    | Table structure                                                                                                                               | Used with `vim.snippet.active()`.                                                                                                                                                     |
|                                         | `vim.snippet.active(filter?)`                      | True if active snippet in current buffer, optionally applying filter. `[NUMHI]`                                                                                                                                                                                                                   | `filter`: `vim.snippet.ActiveFilter?`.                                                                                                                                                                                                                                             | `boolean`                                                                                                                                     | `if vim.snippet.active({direction=1}) then ... end`. `[NUMHI]`                                                                                                                        |
|                                         | `vim.snippet.expand(input)`                        | Expands snippet text. Tabstops highlighted with `hl-SnippetTabstop`. `[NUMHI]`                                                                                                                                                                                                                    | `input`: string (snippet text).                                                                                                                                                                                                                                                    | N/A                                                                                                                                           | `vim.snippet.expand("Hello $1")`. `[NUMHI]`                                                                                                                                           |
|                                         | `vim.snippet.jump(direction)`                      | Jumps to next/previous placeholder in current snippet. `[NUMHI]`                                                                                                                                                                                                                                  | `direction`: `vim.snippet.Direction` (-1 prev, 1 next).                                                                                                                                                                                                                            | N/A                                                                                                                                           | `vim.keymap.set('i', '<Tab>', function() if vim.snippet.active({d=1}) then vim.snippet.jump(1) else return '<Tab>' end end, {expr=true})`. `[NUMHI]`                                  |
|                                         | `vim.snippet.stop()`                               | Exits current snippet. `[NUMHI]`                                                                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                    | N/A                                                                                                                                           | Can be mapped to e.g. `<Esc>`. `[NUMHI]`                                                                                                                                              |
| **Lua module: `vim.text`**              | `vim.text.hexdecode(enc)`                          | Hex decode string.                                                                                                                                                                                                                                                                                | `enc`: string.                                                                                                                                                                                                                                                                     | `string?` (decoded), `string?` (error msg)                                                                                                    |                                                                                                                                                                                       |
|                                         | `vim.text.hexencode(str)`                          | Hex encode string.                                                                                                                                                                                                                                                                                | `str`: string.                                                                                                                                                                                                                                                                     | `string` (hex encoded)                                                                                                                        |                                                                                                                                                                                       |
|                                         | `vim.text.indent(size, text, opts?)`               | Sets indent (leading whitespace) of non-empty lines in `text` to `size` spaces/tabs. Indent char decided by first indented line. `opts.expandtab` treats tabs as spaces. `[NUMHI]`                                                                                                                | `size`: integer. `text`: string. `opts`: `{expandtab?: number}`. To dedent, `size=0`. To ignore final blank line, `text:gsub('\n[\t ]+\n?$', '\n')`.                                                                                                                               | `string` (indented text), `integer` (original indent size)                                                                                    | `vim.text.indent(0, ' a\n  b\n')`. `[NUMHI]`                                                                                                                                          |
| **Lua module: `tohtml`**                | `[:TOhtml]()`                                      | `:TOhtml {file}`: Converts current window buffer to HTML, opens in new split, saves to `{file}` (or temp file).                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                    | N/A                                                                                                                                           | For generating HTML from buffer content.                                                                                                                                              |
|                                         | `tohtml.tohtml(winid?, opt?)`                      | Converts buffer in `winid` (def current) to HTML, returns list of strings.                                                                                                                                                                                                                        | `opt`: `{title=str                                                                                                                                                                                                                                                                 | false, number_lines=bool, font=str[]                                                                                                          | str, width=int, range=int[]}`.                                                                                                                                                        | `string[]` (HTML lines)                                            |                                                   |
